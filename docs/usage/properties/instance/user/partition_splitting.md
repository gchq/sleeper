## Instance Properties - Partition Splitting - User Defined

The following instance properties relate to the splitting of partitions.

| Property Name                                                      | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | Default Value | Run CDK Deploy When Changed |
|--------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------|-----------------------------|
| sleeper.partition.splitting.period.minutes                         | The frequency in minutes with which the lambda runs to find partitions that need splitting and send jobs to the splitting lambda.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | 30            | true                        |
| sleeper.partition.splitting.files.maximum                          | When a partition needs splitting, a partition splitting job is created. This reads in the sketch files associated to the files in the partition in order to identify the median. This parameter controls the maximum number of files that are read in.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | 50            | false                       |
| sleeper.partition.splitting.finder.batch.size                      | The number of tables to find partitions to split for in a single invocation. This will be the batch size for a lambda as an SQS FIFO event source. This can be a maximum of 10.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | 1             | true                        |
| sleeper.partition.splitting.finder.memory.mb                       | The amount of memory in MB for the lambda function used to identify partitions that need to be split.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |               | true                        |
| sleeper.partition.splitting.finder.timeout.seconds                 | The timeout in seconds for the lambda function used to identify partitions that need to be split.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | 900           | true                        |
| sleeper.partition.splitting.finder.concurrency.reserved            | The reserved concurrency for the find partitions to split lambda.<br>See reserved concurrency overview at: https://docs.aws.amazon.com/lambda/latest/dg/configuration-concurrency.html                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |               | true                        |
| sleeper.partition.splitting.finder.concurrency.max                 | The maximum given concurrency allowed for the find partitions to split lambda.<br>See maximum concurrency overview at: https://aws.amazon.com/blogs/compute/introducing-maximum-concurrency-of-aws-lambda-functions-when-using-amazon-sqs-as-an-event-source/                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |               | true                        |
| sleeper.partition.splitting.memory.mb                              | The amount of memory in MB for the lambda function used to split partitions.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |               | true                        |
| sleeper.partition.splitting.timeout.seconds                        | The timeout in seconds for the lambda function used to split partitions.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | 900           | true                        |
| sleeper.partition.splitting.reserved.concurrency                   | The number of lambda instances to reserve from your AWS account's quota for splitting partitions. Note that this will not provision instances until they are needed. Each time partition splitting runs, a separate lambda invocation will be made for each partition that needs to be split. If the reserved concurrency is less than the number of partitions that need to be split across all Sleeper tables in the instance, these invocations may queue up.                                                                                                                                                                                                                                                                                     | 10            | true                        |
| sleeper.default.table.partition.splitting.threshold                | This is the default value of the partition splitting threshold. Partitions with more than the following number of rows in will be split. This value can be overridden on a per-table basis.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | 1000000000    | false                       |
| sleeper.default.table.partition.splitting.min.rows                 | When expanding the partition tree explicitly, this is the default for how many rows are required in the input data to be able to split a partition. This will be used when pre-splitting partitions.<br>For example, during bulk import when there are too few leaf partitions, the partition tree will be extended based on the data in the bulk import job. The bulk import job must contain at least this much data per new split point.                                                                                                                                                                                                                                                                                                          | 1000          | false                       |
| sleeper.default.table.partition.splitting.min.distribution.percent | When expanding the partition tree explicitly, this is the default for a minimum percentage of the expected number of rows to split a partition assuming an even distribution of rows.<br>For example, during bulk import when there are too few leaf partitions, the partition tree will be extended based on the data in the bulk import job. For each current leaf partition, we make a sketch of the data from the job that's in that partition. We divide the number of rows in the job's input data by the current number of leaf partitions, to get the expected rows per partition. If this propery is set to 10, then any partition with less than 10% of the expected rows per partition will be ignored when extending the partition tree. | 10            | false                       |
